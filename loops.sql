DELIMITER //
CREATE PROCEDURE repete_consulta13 (limite TINYINT UNSIGNED)
BEGIN
    DECLARE contador TINYINT UNSIGNED DEFAULT 0;
    loop_teste: LOOP
        SET contador = contador + 1;
        
        IF contador >= limite THEN
            leave loop_teste;
        END IF;




-- USING 1365545250 AS A SEED TO THE RNG


-- USING 1365545250 AS A SEED TO THE RNG


SELECT
	C_COUNT,
	COUNT(*) AS CUSTDIST
FROM
	(
		SELECT
			C_CUSTKEY,
			COUNT(O_ORDERKEY) AS C_COUNT
		FROM
			CUSTOMER LEFT OUTER JOIN ORDERS ON
				C_CUSTKEY = O_CUSTKEY
				AND O_COMMENT NOT LIKE '%PENDING%DEPOSITS%'
		GROUP BY
			C_CUSTKEY
	) C_ORDERS
GROUP BY
	C_COUNT
ORDER BY
	CUSTDIST DESC,
	C_COUNT DESC;










    END loop loop_teste;
END//
DELIMITER ;

-- Testando:
CALL repete_consulta13(31);
